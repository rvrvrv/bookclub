'use strict';var $btn=$('#searchBtn'),list=[],lastSearch='',timer=void 0;function displaySearchResults(a){list=JSON.parse(a),$('#results').empty(),clearTimeout(timer),list.forEach(function(a,b){a.owner=localStorage.getItem('rv-bookclub-id'),setTimeout(function(){$('#results').append('\n              <div class="col s12 m8 offset-m2 l6 offset-l3 animated fadeIn result" id="'+a.id+'">\n                <h5>'+a.title+'</h5>\n                <h6 class="authors"><i class="fa fa-caret-right"></i>&nbsp;'+a.authors+'</h6>\n                <div class="card horizontal short">\n                  <div class="card-image">\n                    <img src="'+a.thumbnail+'" alt="'+a.title+'">\n                  </div>\n                  <div class="card-stacked">\n                    <div class="card-content">\n                      <p>'+a.description+'</p>\n                      <a class="btn-floating halfway-fab waves-effect waves-light blue" id="'+a.id+'" data-i="'+b+'" data-title="'+a.title+'" onclick="addBook(this, true)">\n                        <i class="material-icons tooltipped" data-tooltip="Add '+a.title+' to your collection">add</i>\n                      </a>\n                    </div>\n                    <div class="card-action">\n                      <a class="bookLink blue-text" href="'+a.link+'" target="_blank">More Info</a>\n                    </div>\n                  </div>\n                </div>\n              </div>\n         ')},80*b)}),setTimeout(function(){$('.tooltipped').tooltip(),progress('hide'),$btn.removeClass('disabled'),$btn.html('Search')},100*list.length)}function search(a){return a.trim()?a.trim().toLowerCase()===lastSearch?Materialize.toast('Please enter a new book title',3e3,'error'):void($('.card-div').addClass('fadeOut'),progress('show'),$btn.addClass('disabled'),$btn.html('<i class="fa fa-spinner fa-spin fa-fw"></i>'),ajaxFunctions.ajaxRequest('GET','/api/search/'+a,displaySearchResults),lastSearch=a.trim().toLowerCase(),timer=setTimeout(function(){Materialize.toast('Search took too long. Please try again.',3e3,'error'),lastSearch='',$('#bookInput').val(''),progress('hide'),$btn.removeClass('disabled'),$btn.html('Search')},7e3)):Materialize.toast('Please enter a book title',3e3,'error')}function addBook(a){progress('show'),$(a).addClass('disabled');var b='/api/book/'+a.getAttribute('id')+'/'+localStorage.getItem('rv-bookclub-id');ajaxFunctions.ajaxRequest('PUT',b,function(){$.post(b,list[$(a).data('i')]).done(function(b){'exists'===b?Materialize.toast($(a).data('title')+' is already in your collection!',5e3):Materialize.toast('Added '+b.title+' to your collection!',5e3),$(a).html('<i class="material-icons">thumb_up</i>'),progress('hide')}).fail(function(){console.error('Could not load data')})})}$btn.click(function(){return search($('#bookInput').val())}),$('#bookForm').on('submit',function(a){a.preventDefault(),search($('#bookInput').val())});